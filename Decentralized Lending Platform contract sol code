function cancelLoanRequest(uint256 loanId) public {
    LoanRequest storage loan = loanRequests[loanId];
    require(msg.sender == loan.borrower, "Only borrower can cancel.");
    require(!loan.isApproved, "Loan already approved.");

    delete loanRequests[loanId];

    // Remove from borrower's list
    uint256[] storage userLoans = borrowerLoans[msg.sender];
    for (uint256 i = 0; i < userLoans.length; i++) {
        if (userLoans[i] == loanId) {
            userLoans[i] = userLoans[userLoans.length - 1];
            userLoans.pop();
            break;
        }
    }
}
